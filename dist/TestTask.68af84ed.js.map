{"version":3,"sources":["Popup/popup.js","index.js"],"names":["getTemplate","options","popup","document","createElement","className","innerHTML","videoSrc","_focusElements","Popup","selector","init","$play","querySelector","$popup","open","bind","close","listener","focusContol","destroyed","opened","closed","focusEl","nodes","querySelectorAll","console","log","focus","length","event","target","dataset","keyCode","onOpen","classList","add","onClose","remove","removeEventListener","body","appendChild","addEventListener","img","maidBg","btnImg","modal","registerListener","setLazy","lazyLoad","lazy","i","dataLazy","getAttribute","isInViewport","src","style","backgroundImage","removeAttribute","cleanLazy","Array","prototype","filter","call","l","el","rect","getBoundingClientRect","bottom","right","top","window","innerHeight","documentElement","clientHeight","left","innerWidth","clientWidth","func","attachEvent"],"mappings":";AAqFG,aAAA,SAAA,EAAA,EAAA,GAAA,KAAA,aAAA,GAAA,MAAA,IAAA,UAAA,qCAAA,SAAA,EAAA,EAAA,GAAA,IAAA,IAAA,EAAA,EAAA,EAAA,EAAA,OAAA,IAAA,CAAA,IAAA,EAAA,EAAA,GAAA,EAAA,WAAA,EAAA,aAAA,EAAA,EAAA,cAAA,EAAA,UAAA,IAAA,EAAA,UAAA,GAAA,OAAA,eAAA,EAAA,EAAA,IAAA,IAAA,SAAA,EAAA,EAAA,EAAA,GAAA,OAAA,GAAA,EAAA,EAAA,UAAA,GAAA,GAAA,EAAA,EAAA,GAAA,EAAA,SAAA,EAAA,EAAA,EAAA,GAAA,IAAA,EAAA,IAAA,GAAA,MAAA,IAAA,UAAA,kDAAA,OAAA,EAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,WAAA,EArFH,IAAMA,EAAc,SAACC,GACbC,IAAAA,EAAQC,SAASC,cAAc,OAwB9BF,OAvBPA,EAAMG,UAAY,QAClBH,EAAMI,UAUQL,iUAAAA,OAAAA,EAAQM,SAVtB,gUAsBOL,GAGHM,EAAiB,CACrB,UACA,aACA,gEACA,4CACA,8CACA,4CACA,SACA,SACA,QACA,oBACA,mCA8CC,EAAA,IAAA,QAAA,EAAA,IAAA,QA3CUC,EAAAA,WACCC,SAAAA,EAAAA,EAAUT,GAAS,EAAA,KAAA,GAAA,EAAA,IAAA,MAAA,EAAA,IAAA,MACxBU,KAAAA,KAAKD,EAAUT,GAyCrB,OAAA,EAAA,EAAA,CAAA,CAAA,IAAA,OAtCD,MAAA,SAAKS,EAAUT,GACRA,KAAAA,QAAUA,EACVW,KAAAA,MAAQT,SAASU,cAAcH,GAC/BI,KAAAA,OAASd,EAAYC,GACrBc,KAAAA,KAAO,KAAKA,KAAKC,KAAK,MACtBC,KAAAA,MAAQ,KAAKA,MAAMD,KAAK,MACxBE,KAAAA,SAAW,KAAKA,SAASF,KAAK,MAC9BG,KAAAA,YAAc,KAAKA,YAAYH,KAAK,MAEzC,EAAA,KAAA,EAAA,GAAA,KAAA,MACKI,KAAAA,WAAY,EACZC,KAAAA,QAAS,EACTC,KAAAA,QAAS,EACTC,KAAAA,UAyBN,CAAA,IAAA,cAtBD,MAAA,WACQC,IAAAA,EAAQ,KAAKV,OAAOW,iBAAiBjB,GAC3CkB,QAAQC,IAAIH,GACR,KAAKF,QAAU,KAAKV,OACtBc,QAAQC,IAAI,KAAKf,OACZA,KAAAA,MAAMgB,SAEPJ,EAAMK,SACRH,QAAQC,MACRH,EAAM,GAAGI,WAad,CAAA,IAAA,WAED,MAAA,SAASE,IAELA,EAAMC,OAAOC,QAAQf,OACF,KAAlBa,EAAMG,UAAkC,IAAhB,KAAKZ,SAEzBJ,KAAAA,UAPR,CAAA,IAAA,OAWD,MAAA,WACM,KAAKG,UACPM,QAAQC,IAAI,yBAGTN,KAAAA,QAAS,EACTC,KAAAA,QAAS,EACiB,mBAAxB,KAAKrB,QAAQiC,QAAyB,KAAKjC,QAAQiC,SAC1D,EAAA,KAAA,EAAA,GAAA,KAAA,MACKpB,KAAAA,OAAOqB,UAAUC,IAAI,QACrBjB,KAAAA,iBArBN,CAAA,IAAA,QAwBD,MAAA,WACOE,KAAAA,QAAS,EACTC,KAAAA,QAAS,EACkB,mBAAzB,KAAKrB,QAAQoC,SAA0B,KAAKpC,QAAQoC,UACtDvB,KAAAA,OAAOqB,UAAUG,OAAO,QACxBnB,KAAAA,gBA7BN,CAAA,IAAA,UAgCD,MAAA,WACOC,KAAAA,WAAY,EAEZN,KAAAA,OAAOyB,oBAAoB,QAAS,KAAKrB,cAnC/C,EA3CUT,GAmCD,SAAA,IACRN,SAASqC,KAAKC,YAAY,KAAK3B,QAGxB,SAAA,IACFF,KAAAA,MAAM8B,iBAAiB,QAAS,KAAK3B,MACrCD,KAAAA,OAAO4B,iBAAiB,QAAS,KAAKxB,UAC3Cf,SAASuC,iBAAiB,UAAW,KAAKxB,UAC3C,QAAA,MAAA;;;;;;;;ACVF,aA3ED,IAAA,EAAA,QAAA,iBACA,QAAA,sBACA,IAAA,EAAA,EAAA,QAAA,sBACA,EAAA,EAAA,QAAA,sBAwEC,SAAA,EAAA,GAAA,OAAA,GAAA,EAAA,WAAA,EAAA,CAAA,QAAA,GAvED,IAAMyB,EAAM,CAACC,EAAD,QAASC,EAAT,SAENC,EAAQ,IAAIrC,EAAJ,MAAU,QAAS,CAC/BF,SAAU,4CACV2B,OAAS,WACPR,QAAQC,IAAI,WAEdU,QAAU,WACRX,QAAQC,IAAI,cAKhBoB,EAAiB,OAAQC,GACzBD,EAAiB,OAAQE,GACzBF,EAAiB,SAAUE,GAE3B,IAAIC,EAAO,GAEX,SAASF,IACPE,EAAO/C,SAASsB,iBAAiB,eACjCC,QAAQC,IAAI,SAAWuB,EAAKrB,OAAS,gBAGvC,SAASoB,IACF,IAAA,IAAIE,EAAI,EAAGA,EAAID,EAAKrB,OAAQsB,IAAK,CAChCC,IAAAA,EAAWF,EAAKC,GAAGE,aAAa,aAChCC,EAAaJ,EAAKC,KAChBD,EAAKC,GAAGE,aAAa,cACN,QAAbD,EACFF,EAAKC,GAAGI,IAAML,EAAKC,GAAGE,aAAa,YACb,eAAbD,IACT1B,QAAQC,IAAIuB,EAAKC,IACjBzB,QAAQC,IAAIgB,EAAIQ,IAGhBD,EAAKC,GAAGK,MAAMC,gBAA0BP,QAAAA,OAAAA,EAAKC,GAAGE,aAC9C,YADF,OAIFH,EAAKC,GAAGO,gBAAgB,aAK9BC,IAGF,SAASA,IACPT,EAAOU,MAAMC,UAAUC,OAAOC,KAAKb,EAAM,SAAUc,GAC1CA,OAAAA,EAAEX,aAAa,cAI1B,SAASC,EAAaW,GAChBC,IAAAA,EAAOD,EAAGE,wBAGZD,OAAAA,EAAKE,QAAU,GACfF,EAAKG,OAAS,GACdH,EAAKI,MAAQC,OAAOC,aAAerE,SAASsE,gBAAgBC,eAC5DR,EAAKS,OAASJ,OAAOK,YAAczE,SAASsE,gBAAgBI,aAIhE,SAAS9B,EAAiBjB,EAAOgD,GAC3BP,OAAO7B,iBACT6B,OAAO7B,iBAAiBZ,EAAOgD,GAE/BP,OAAOQ,YAAY,KAAOjD,EAAOgD","file":"TestTask.68af84ed.js","sourceRoot":"..","sourcesContent":["const getTemplate = (options) => {\r\n  const popup = document.createElement(\"div\");\r\n  popup.className = \"popup\";\r\n  popup.innerHTML = `\r\n    <div class=\"popup__bg\"></div>\r\n    <div class=\"popup__inner\">\r\n      \r\n        <input type=\"checkbox\"/>\r\n        <input type=\"text\"/>\r\n        <button class=\"popup__close-btn\" data-close=\"true\"></button>\r\n      <div class=\"popup__video-container\">\r\n        <iframe\r\n          class=\"popup__video\"\r\n          src=${options.videoSrc}\r\n          title=\"YouTube video player\"\r\n          frameborder=\"0\"\r\n          allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\r\n          allowfullscreen\r\n        ></iframe>\r\n        <input type=\"checkbox\"/>\r\n        <input type=\"text\"/>\r\n\r\n      </div>\r\n    </div>\r\n`;\r\n  return popup;\r\n};\r\n\r\nconst _focusElements = [\r\n  \"a[href]\",\r\n  \"area[href]\",\r\n  'input:not([disabled]):not([type=\"hidden\"]):not([aria-hidden])',\r\n  \"select:not([disabled]):not([aria-hidden])\",\r\n  \"textarea:not([disabled]):not([aria-hidden])\",\r\n  \"button:not([disabled]):not([aria-hidden])\",\r\n  \"iframe\",\r\n  \"object\",\r\n  \"embed\",\r\n  \"[contenteditable]\",\r\n  '[tabindex]:not([tabindex^=\"-\"])',\r\n];\r\n\r\nexport class Popup {\r\n  constructor(selector, options) {\r\n    this.init(selector, options);\r\n  }\r\n\r\n  init(selector, options) {\r\n    this.options = options;\r\n    this.$play = document.querySelector(selector);\r\n    this.$popup = getTemplate(options);\r\n    this.open = this.open.bind(this);\r\n    this.close = this.close.bind(this);\r\n    this.listener = this.listener.bind(this);\r\n    this.focusContol = this.focusContol.bind(this);\r\n\r\n    this.#setup();\r\n    this.destroyed = false;\r\n    this.opened = false;\r\n    this.closed = false;\r\n    this.focusEl;\r\n  }\r\n\r\n  focusContol() {\r\n    const nodes = this.$popup.querySelectorAll(_focusElements);\r\n    console.log(nodes);\r\n    if (this.closed && this.$play) {\r\n      console.log(this.$play);\r\n      this.$play.focus();\r\n    } else {\r\n      if (nodes.length) {\r\n        console.log();\r\n        nodes[0].focus();\r\n      }\r\n    }\r\n  }\r\n\r\n  #render() {\r\n    document.body.appendChild(this.$popup);\r\n  }\r\n\r\n  #setup() {\r\n    this.$play.addEventListener(\"click\", this.open);\r\n    this.$popup.addEventListener(\"click\", this.listener);\r\n    document.addEventListener(\"keydown\", this.listener);\r\n  }\r\n\r\n  listener(event) {\r\n    if (\r\n      event.target.dataset.close ||\r\n      (event.keyCode === 27 && this.opened === true)\r\n    ) {\r\n      this.close();\r\n    }\r\n  }\r\n\r\n  open() {\r\n    if (this.destroyed) {\r\n      console.log(\"Popup was destroyed!\");\r\n      return;\r\n    }\r\n    this.opened = true;\r\n    this.closed = false;\r\n    typeof this.options.onOpen === \"function\" && this.options.onOpen();\r\n    this.#render();\r\n    this.$popup.classList.add(\"open\");\r\n    this.focusContol();\r\n  }\r\n\r\n  close() {\r\n    this.opened = false;\r\n    this.closed = true;\r\n    typeof this.options.onClose === \"function\" && this.options.onClose();\r\n    this.$popup.classList.remove(\"open\");\r\n    this.focusContol();\r\n  }\r\n\r\n  destroy() {\r\n    this.destroyed = true;\r\n    // this.$play.removeEventListener(\"click\", this.open);\r\n    this.$popup.removeEventListener(\"click\", this.listener);\r\n  }\r\n}\r\n","import { Popup } from \"./Popup/popup\";\r\nimport \"./Popup/style.scss\";\r\nimport maidBg from \"./img/main_bg.png\";\r\nimport btnImg from \"./img/btn_img.svg\";\r\nconst img = [maidBg, btnImg];\r\n\r\nconst modal = new Popup(\"#play\", {\r\n  videoSrc: \"https://www.youtube.com/embed/SS9UeThpkNM\",\r\n  onOpen() {\r\n    console.log(\"onOpen\");\r\n  },\r\n  onClose() {\r\n    console.log(\"onClose\");\r\n  },\r\n});\r\n// modal.destroy();\r\n\r\nregisterListener(\"load\", setLazy);\r\nregisterListener(\"load\", lazyLoad);\r\nregisterListener(\"scroll\", lazyLoad);\r\n\r\nvar lazy = [];\r\n\r\nfunction setLazy() {\r\n  lazy = document.querySelectorAll(\"[data-lazy]\");\r\n  console.log(\"Found \" + lazy.length + \" lazy images\");\r\n}\r\n\r\nfunction lazyLoad() {\r\n  for (var i = 0; i < lazy.length; i++) {\r\n    let dataLazy = lazy[i].getAttribute(\"data-lazy\");\r\n    if (isInViewport(lazy[i])) {\r\n      if (lazy[i].getAttribute(\"data-src\")) {\r\n        if (dataLazy === \"img\") {\r\n          lazy[i].src = lazy[i].getAttribute(\"data-src\");\r\n        } else if (dataLazy === \"background\") {\r\n          console.log(lazy[i]);\r\n          console.log(img[i]);\r\n\r\n          // lazy[i].style.backgroundImage = `url(\"${img[i]}\")`;\r\n          lazy[i].style.backgroundImage = `url(\"${lazy[i].getAttribute(\r\n            \"data-src\"\r\n          )}\")`;\r\n        }\r\n        lazy[i].removeAttribute(\"data-src\");\r\n      }\r\n    }\r\n  }\r\n\r\n  cleanLazy();\r\n}\r\n\r\nfunction cleanLazy() {\r\n  lazy = Array.prototype.filter.call(lazy, function (l) {\r\n    return l.getAttribute(\"data-src\");\r\n  });\r\n}\r\n\r\nfunction isInViewport(el) {\r\n  var rect = el.getBoundingClientRect();\r\n\r\n  return (\r\n    rect.bottom >= 0 &&\r\n    rect.right >= 0 &&\r\n    rect.top <= (window.innerHeight || document.documentElement.clientHeight) &&\r\n    rect.left <= (window.innerWidth || document.documentElement.clientWidth)\r\n  );\r\n}\r\n\r\nfunction registerListener(event, func) {\r\n  if (window.addEventListener) {\r\n    window.addEventListener(event, func);\r\n  } else {\r\n    window.attachEvent(\"on\" + event, func);\r\n  }\r\n}\r\n"]}